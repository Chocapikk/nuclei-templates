id: CVE-2023-38198

info:
  name: acme.sh < 3.0.6 - Command Injection
  author: Chocapikk
  severity: critical
  description: |
    acme.sh versions before 3.0.6 are vulnerable to command injection via the eval function in _getdeployconf().
    The function uses eval to execute configuration values without proper validation, allowing remote attackers
    to execute arbitrary commands if they can control the ACME server responses or configuration values.
  impact: |
    Remote attackers can execute arbitrary commands on systems using vulnerable versions of acme.sh,
    potentially leading to complete system compromise, including unauthorized access to private keys
    and other sensitive data.
  remediation: |
    Upgrade to acme.sh version 3.0.6 or later.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-38198
    - https://wiz.io/vulnerability-database/cve/cve-2023-38198
    - https://github.com/acmesh-official/acme.sh/releases/tag/3.0.6
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-38198
    cwe-id: CWE-78
  metadata:
    verified: true
    max-request: 1
    vendor: acmesh-official
    product: acme.sh
  tags: cve,cve2023,rce,command-injection,acme.sh,ssl,tls,certificate

http:
  - method: GET
    path:
      - "{{BaseURL}}/.acme.sh/acme.sh"
      - "{{BaseURL}}/acme.sh"
      - "{{BaseURL}}/acme.sh/acme.sh"
      - "{{BaseURL}}/~/.acme.sh/acme.sh"
    matchers:
      - type: regex
        part: body
        regex:
          - 'VER=3\.0\.[0-5]'
          - 'VER=3\.0\.[0-4]'
          - 'VER=3\.0\.[0-3]'
          - 'VER=3\.0\.[0-2]'
          - 'VER=3\.0\.[0-1]'
          - 'VER=3\.0\.0'
          - 'VER=2\.[0-9]'
          - 'VER=1\.[0-9]'
        condition: or
      - type: word
        part: body
        words:
          - "PROJECT_NAME=\"acme.sh\""
          - "acmesh-official"
        condition: and

